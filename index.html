<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>
    <script defer src="./firebase-init.js"></script>

    <title>fastmate</title>
    <link rel="stylesheet" href="./styles.css">
    <style>
        /* [추가] 로딩 중 내용 숨기기 */
        .intro-container {
            visibility: hidden; /* 일단 숨김 */
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        .intro-container.show {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/sw.js').then(registration => {
                console.log('ServiceWorker registration successful with scope: ', registration.scope);
            }, err => {
                console.log('ServiceWorker registration failed: ', err);
            });
        });
    }
</script>
<body>

    <div class="intro-container">
        <h1 class="logo">fastmate</h1>
        <p class="intro-text">단식을<br>쉽게 관리하세요.</p>
        <button onclick="window.location.href='./signup.html'" class="main-button">시작하기</button>
        <p class="login-link">
            이미 회원이라면 <a href="./login.html">로그인</a>
        </p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const introContainer = document.querySelector('.intro-container');

            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    // 로그인된 사용자는 즉시 환영 화면으로 이동
                    window.location.replace('./welcome.html');
                } else {
                    // [수정] 로그인되지 않은 사용자일 때만 내용을 보여줌
                    if (introContainer) {
                        introContainer.classList.add('show');
                    }
                }
            });
        });
    </script>
    
</body>
</html>